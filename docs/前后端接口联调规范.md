# 前后端接口联调规范

首先，明确前后端分离的意思是：前后端只通过 `JSON` 来交流，组件化、工程化不需要依赖后端去实现。

那为什么要进行分离：

- 关注分离点
- 职责分离
- 对的人做对的事
- 更好的共建模式
- 快速的响应变化

**分离之后后端职责**：

- 提供数据
- 处理业务逻辑
- 代码跑在服务器上

**分离之后前端职责**：

- 接收数据，返回数据
- 处理渲染逻辑
- 代码跑在浏览器上

## 接口文档

**接口联调应该围绕接口文档来进行**

接口文档建议统一采用 [apiDoc](http://apidocjs.com/) 生成，一切需求以接口文档为主。有改动，需要改文档，再改代码。

提出更改需求后，应和相关开发人员确认。

接口文档需要写明接口请求地址、接口请求方式、接口请求参数、接口成功响应字段、接口错误响应字段、用例等信息。

## 接口请求地址

接口请求地址写法如下：

```
/user/:id
```

服务器请求地址应该在文档顶部信息里写明，请求地址由服务器地址与接口请求地址组成。

## 接口请求方式

接口请求方式应写明：

- POST
- GET
- DELETE

等等接口请求方式

## 接口请求参数

接口请求参数应该写明：

- Field ,参数字段名称
- Type ,参数类型
- Description ,参数描述

## 接口响应字段

接口响应字段应该包含：

- code ,接口状态
- message ,接口请求消息
- data ,接口请求数据

```json
{
 success: true,
 data: 1,
 message: 'ok',
 code: 200
}
```

## 接口成功响应字段

针对接口成功响应（`success: true`）时，应该在 `data` 中包含成功请求的 `json` 信息。

`data` 的结构层级应该清晰明了，不应该存在无意义的多层层级，比如：

```json
data: {
  data: {
    name: 'Angus',
    age: 18
  }
}
```

`data` 中的字段数据不应该存在过多无意义的字段（指与前端对接过程中无法使用的数据），字段名称应该语义化，不应该存在错别字或者容易引起歧义的单词

在 `apiDoc` 文档中应该标明响应成功后的字段说明，如下：

- Field ,字段名
- Type ,字段类型
- Description ,字段描述

其中，在文档中标明的字段类型应该与实际接口返回的字段类型一致，如出现不一致或者不稳定，应该联系后台接口开发人员改正。

## 接口错误响应字段

每一个接口都应该存在错误响应的处理，错误响应的状态码应该由后台开发人员制定统一的标准。

一般来说，请求的参数错误（或者不合理）属于 **400 Bad Request**。也可以选择其他合理的 **4xx**（表示请求错误）代码，**404 Not Found**除外。

当然，在响应 **200** 里也能返回数据，在响应数据中说明错误类型，给出错误信息。

这时候的数据格式应该和 `接口成功响应字段` 保持一致：

```json
{
 success: false,
 data: null,
 message: '您的token已过期',
 code: 401
}
```

如果统一采用这种 **200** 状态码响应返回数据，这时候响应数据里的 `code` 应该给出具体的标准对应不同的状态，例如：

- 200 请求成功
- 201 已创建
- 202 已接收
- 203 非授权信息
- 204 无内容
- 401 身份验证错误
- 403 服务器拒绝请求
- 404 未找到

## 用例

`apiDoc` 提供了一种类似 `PostMan` 的模拟请求方式，对于一些不是很好理解的接口时，可以采取使用用例的方式，给前端人员提供一种直观的接口对接方式。
